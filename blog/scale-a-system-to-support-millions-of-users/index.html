<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo/FlamingBytes-icon-64x64-1.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo/FlamingBytes-icon-64x64-1.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo/FlamingBytes-icon-64x64-1.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.flamingbytes.com","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Start from single serverBuilding a large scale system is not one time effort, it should be an iterative process as the user workload increases. The journey could just start with single server and sing">
<meta property="og:type" content="article">
<meta property="og:title" content="Scale a system to support millions of users">
<meta property="og:url" content="https://www.flamingbytes.com/blog/scale-a-system-to-support-millions-of-users/index.html">
<meta property="og:site_name" content="FlamingBytes">
<meta property="og:description" content="Start from single serverBuilding a large scale system is not one time effort, it should be an iterative process as the user workload increases. The journey could just start with single server and sing">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-1.png">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-2.png">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-3.png">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-4.png">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-5.png">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-6.png">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-7.png">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-8.png">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-9.png">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-10.png">
<meta property="og:image" content="https://www.flamingbytes.com/images/scale-million-users-11.png">
<meta property="article:published_time" content="2022-03-13T16:00:00.000Z">
<meta property="article:modified_time" content="2023-10-22T18:28:20.000Z">
<meta property="article:author" content="relentlesstorm">
<meta property="article:tag" content="System Design">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.flamingbytes.com/images/scale-million-users-1.png">


<link rel="canonical" href="https://www.flamingbytes.com/blog/scale-a-system-to-support-millions-of-users/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://www.flamingbytes.com/blog/scale-a-system-to-support-millions-of-users/","path":"blog/scale-a-system-to-support-millions-of-users/","title":"Scale a system to support millions of users"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Scale a system to support millions of users | FlamingBytes</title>
  







<!-- Google Adsense-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8578408127828851"
     crossorigin="anonymous"></script>

<!-- Google tag (gtag.js) for analytics-->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B8PQ47L2H0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B8PQ47L2H0');
</script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">FlamingBytes</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">10</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">94</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">252</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Start-from-single-server"><span class="nav-number">1.</span> <span class="nav-text">Start from single server</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Database"><span class="nav-number">2.</span> <span class="nav-text">Database</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL-vs-NoSQL"><span class="nav-number">2.1.</span> <span class="nav-text">SQL vs. NoSQL</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vertical-scaling-vs-horizontal-scaling"><span class="nav-number">3.</span> <span class="nav-text">Vertical scaling vs. horizontal scaling</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Load-balancer"><span class="nav-number">4.</span> <span class="nav-text">Load balancer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Database-replication"><span class="nav-number">5.</span> <span class="nav-text">Database replication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cache"><span class="nav-number">6.</span> <span class="nav-text">Cache</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Content-Delivery-Network-CDN"><span class="nav-number">7.</span> <span class="nav-text">Content Delivery Network(CDN)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Stateless-web-tier"><span class="nav-number">8.</span> <span class="nav-text">Stateless web tier</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Data-centers"><span class="nav-number">9.</span> <span class="nav-text">Data centers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Message-queue"><span class="nav-number">10.</span> <span class="nav-text">Message queue</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Logging-monitoring-automation"><span class="nav-number">11.</span> <span class="nav-text">Logging, monitoring, automation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Database-scaling"><span class="nav-number">12.</span> <span class="nav-text">Database scaling</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Conclusion"><span class="nav-number">13.</span> <span class="nav-text">Conclusion</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="relentlesstorm"
      src="/images/logo/FlamingBytes-icon-64x64-1.png">
  <p class="site-author-name" itemprop="name">relentlesstorm</p>
  <div class="site-description" itemprop="description">Stay hungry, stay foolish</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">252</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">94</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="mailto:relentlesstorm@gmail.com" title="E-Mail → mailto:relentlesstorm@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
        <div class="sidebar-inner sidebar-post-related">
          <div class="animated">
              <div class="links-of-blogroll-title"><i class="fa fa-signs-post fa-fw"></i>
    Related Posts
  </div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/blog/backup-and-restore-mysql-database/" rel="bookmark">
        <time class="popular-posts-time">2021-09-28</time>
        <br>
      Backup and restore MySQL database
      </a>
    </li>
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/blog/the-complete-guide-to-system-design/" rel="bookmark">
        <time class="popular-posts-time">2022-05-04</time>
        <br>
      The complete guide to System Design
      </a>
    </li>
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/blog/database-concepts-you-should-know/" rel="bookmark">
        <time class="popular-posts-time">2022-02-12</time>
        <br>
      Database concepts you should know
      </a>
    </li>
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/blog/what-is-performance-engineering/" rel="bookmark">
        <time class="popular-posts-time">2022-04-08</time>
        <br>
      What is Performance Engineering
      </a>
    </li>
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/blog/a-six-step-framework-to-tackle-any-system-design-questio/" rel="bookmark">
        <time class="popular-posts-time">2022-05-08</time>
        <br>
      A six-step framework to tackle any system design question
      </a>
    </li>
  </ul>

          </div>
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/scale-a-system-to-support-millions-of-users/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Scale a system to support millions of users | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Scale a system to support millions of users
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-03-13 09:00:00" itemprop="dateCreated datePublished" datetime="2022-03-13T09:00:00-07:00">2022-03-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/Programming/" itemprop="url" rel="index"><span itemprop="name">Programming</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="Start-from-single-server"><a href="#Start-from-single-server" class="headerlink" title="Start from single server"></a>Start from single server</h2><p>Building a large scale system is not one time effort, it should be an iterative process as the user workload increases. The journey could just start with single server and single user request.</p>
<p><img src="/images/scale-million-users-1.png" alt="Image"></p>
<ol>
<li>User access a website through domain name, such as example.com</li>
<li>IP address is returned to the browser or the mobile app.</li>
<li>HTTP requests are sent to the web server.</li>
<li>The web server returns the requested resources, such as a HTML page or JSON response.</li>
</ol>
<h2 id="Database"><a href="#Database" class="headerlink" title="Database"></a>Database</h2><p>With the growth of the user base, we can separate the web server and database server to allow them scale independently.</p>
<p><img src="/images/scale-million-users-2.png" alt="Image"></p>
<h3 id="SQL-vs-NoSQL"><a href="#SQL-vs-NoSQL" class="headerlink" title="SQL vs. NoSQL"></a>SQL vs. NoSQL</h3><p>We can choose between relational database and non-relational database.</p>
<p>Relational database is also called relational database management system(RDBMS) or SQL database. The popular relational databases are MySQL, Oracle database, MS-SQL database, PostgreSQL and so on. Relational database stores data in tables and rows. Join operations can be performed across different database tables.</p>
<p>Non-relational database is also called NoSQL database. The popular ones are MongoDB, CouchDB, Cassandra, HBase, Neo4j, Amazon DynamoDB and so on. They can be grouped into four categories: key-value stores, graph stores, column stores, and document stores. Generally, join operations are not supported in non-relational database.</p>
<p>Non-relational database might be the choice if:</p>
<ul>
<li>very low latency is required</li>
<li>data is unstructured or not relational</li>
<li>the data needs to be serialized and deserialied(JSON, XML, YAML, etc)</li>
<li>massive amount of data needs to be stored</li>
</ul>
<h2 id="Vertical-scaling-vs-horizontal-scaling"><a href="#Vertical-scaling-vs-horizontal-scaling" class="headerlink" title="Vertical scaling vs. horizontal scaling"></a>Vertical scaling vs. horizontal scaling</h2><p>Vertical scaling, also called “scale up”, means adding more compute power(CPU&#x2F;Memory), disk bandwidth, and network bandwidth to the servers. Vertical scaling is simple but it’s impossible to add unlimited resource to a single server. It doesn’t provide failover and redundancy and it may cause single point of failure.</p>
<p>Horizontal scaling, also called “scale out”, means adding more servers to the resouce pool. It’s suitable for large scale applications.</p>
<h2 id="Load-balancer"><a href="#Load-balancer" class="headerlink" title="Load balancer"></a>Load balancer</h2><p>With the single server setup, users won’t be able to access the website if the web server goes offline. Users may experience slow response(high latency) or failed connection if there are too many user requests to the server simultaneously.</p>
<p>A load balancer can help evenly distribute incoming traffic among web servers.</p>
<p><img src="/images/scale-million-users-3.png" alt="Image"></p>
<p>Users connect to the public IP of the load balancer. The web servers sitting behind the load balancer are unreachable directly by the users anymore. The private IPs can be used for communications between load balancer and web servers.</p>
<p>After the load balancer and more web servers are added, we improved the high availability of the web servers. For example, if web server 1 goes offline, the traffic can be routed to other web servers which are still healthy. As the website traffic grows rapidly, we can always add more web servers to scale and handle the incoming traffic.</p>
<h2 id="Database-replication"><a href="#Database-replication" class="headerlink" title="Database replication"></a>Database replication</h2><p>Now that we can scale the web tier as needed, how about the data tier? Database replication is a common technique to address the problems like failover and redundancy.</p>
<p>“Database replication can be used on many database management systems (DBMS), usually with a primary&#x2F;replica relationship between the original and the copies.” <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Replication_(computing)">Source</a></p>
<p>A master database generally supports write operations only. A slave database replicates data from master and only supports read operations.</p>
<p><img src="/images/scale-million-users-4.png" alt="Image"></p>
<p>The master-slave model may not be the only method. We just use this model to learn about how to scale the database tier. We can achieve much better performance by spearating the write and read operations to master and slave databases. It also provides the data reliability in the case of natural disaster like earthquake.  The data is highly available even if a database is offline.</p>
<ul>
<li>If the master database goes offline, a slave database will be promoted as the new master. A new slave database will replace the old one for data replication. Promoting a master is not that simple process because the data in slave database may not be up to date. The missing data have to be recovered by some recovery mechanism.</li>
<li>If the slave databases are go offline, read operations can be directed to master database temporarily until a new slave database is in place.</li>
</ul>
<h2 id="Cache"><a href="#Cache" class="headerlink" title="Cache"></a>Cache</h2><p>After we have the design of scalable web and data tier, it’s time to improve the system performance like response time. Adding a cache layer can help serve the user requests more quickly.</p>
<ol>
<li>If data exists in cache, read data from cache</li>
<li>If data doesn’t exist in cache, fetch data from database and save data to cache. Then the cached data are returned to web servers. This is so called read-through cache.</li>
</ol>
<p><img src="/images/scale-million-users-5.png" alt="Image"></p>
<p>Here are some considerations for using a cache system:</p>
<ul>
<li>Consider using cache when the data is read frequently but write(modification) infrequently</li>
<li>Use an expiration policy to reload the data from data store</li>
<li>Use an eviction policy to add data to the already full cache. Least-recently-used(LRU) or First in First Out(FIFO)?</li>
<li>Maintain the consistency between data store and cache. MemCache solution?</li>
<li>Avoid single point of failure of a cache system</li>
</ul>
<h2 id="Content-Delivery-Network-CDN"><a href="#Content-Delivery-Network-CDN" class="headerlink" title="Content Delivery Network(CDN)"></a>Content Delivery Network(CDN)</h2><p>A CDN is a network of geographially dispersed servers used to deliver static content. CDN servers cache static content like images, videos, CSS, Javascript files, etc.</p>
<p>When a user visits a website, a CDN server closest to the user will deliver the static content. The website loads faster from a closer CDN server.</p>
<p><img src="/images/scale-million-users-6.png" alt="Image"></p>
<ol>
<li>If the content to be loaded is not in CDN, get it from the origin server and store it in CDN server.</li>
<li>If the content is in CDN, return it from CDN.</li>
</ol>
<p><img src="/images/scale-million-users-7.png" alt="Image"></p>
<h2 id="Stateless-web-tier"><a href="#Stateless-web-tier" class="headerlink" title="Stateless web tier"></a>Stateless web tier</h2><p>In order to scale the web tier horizontally, we need to move the state(e.g. user session data) out of the web tier. A practice is to store the session data in the persistent storage such as SQL or NoSQL database. The web servers in the cluster can access the state data from the database. This is called stateless web tier.</p>
<p>In the stateless architecture, the HTTP requests from many users can be sent to any web servers. The session data will be fetched from a shared data store which is separated from web servers.</p>
<p><img src="/images/scale-million-users-8.png" alt="Image"></p>
<p>After the session data is stored out of web servers, auto-scaling of the web tier becomes a lot more easier.</p>
<p><img src="/images/scale-million-users-9.png" alt="Image"></p>
<h2 id="Data-centers"><a href="#Data-centers" class="headerlink" title="Data centers"></a>Data centers</h2><p>As the website access grows internationally, supporting multiple data centers globally is crucial. In the event of any data center outage, the traffic can be directed to a healthy data center as well.</p>
<p><img src="/images/scale-million-users-10.png" alt="Image"></p>
<h2 id="Message-queue"><a href="#Message-queue" class="headerlink" title="Message queue"></a>Message queue</h2><p>To further scale the system, we can decouple the system components so that they can be scaled independently.</p>
<p>A message queue is a durable component, stored in memory, that supports asynchronous communication. It serves as a buffer and distributes asynchronous requests. Typically, a message queue has an input service, also called producers&#x2F;publishers, to create message, and publish them to the message queue. The consumer services connect to the queue and process the messages asynchronously.</p>
<p><img src="/images/scale-million-users-11.png" alt="Image"></p>
<h2 id="Logging-monitoring-automation"><a href="#Logging-monitoring-automation" class="headerlink" title="Logging, monitoring, automation"></a>Logging, monitoring, automation</h2><p>As the system scale for a very large business, it’s necessary to invest in the logging, monitoring and automation. These tools can help troubleshoot issues, understand system insight and system health, and improve productivity.</p>
<h2 id="Database-scaling"><a href="#Database-scaling" class="headerlink" title="Database scaling"></a>Database scaling</h2><p>Vertical scaling and horizontal scaling are the two approaches for database scaling.</p>
<p>Vertical scaling, also known as scaling up, is to scale by adding more hardware components(CPU, Memory, Disk, Network) to the existing server. But it has a hardware limit and the cost can be high. Also there is risk of single point of failures.</p>
<p>Horizontal scaling, also known as sharding, is a practice of adding more database servers. Sharding separates large databases to smaller ones which are called shards. A hash function(e.g. user_id % n) can be used to determine which shard should be accessed. In this example of hash function, the user_id is the sharding key which is an important factor to consider when to implement a sharding strategy. The goal is to choose a key which can evenly distribute the data across shards.</p>
<p>With database sharding, it may introduce complexities and new challenges to the system.</p>
<ul>
<li>resharding data</li>
<li>hotspot key</li>
<li>join operations across database shards</li>
</ul>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Scaling a system is an iterative process. As the user requests increase and system scales, more fine-tuning and new strategies are needed. In summary, we can scale the system to support millions of users by addressing the following areas.</p>
<ul>
<li>Keep web tier stateless by storing session data out of web servers</li>
<li>Have redundancy for each tier</li>
<li>Cache data as much as possible to improve response time</li>
<li>Build multiple data centers</li>
<li>Use CDN to serve static content</li>
<li>Sharding the data tier if needed</li>
<li>Decouple the components to increase throughput(e.g. message queue)</li>
<li>Add tools to improve ease of use</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/System-Design/" rel="tag"><i class="fa fa-tag"></i> System Design</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/blog/set-in-golang/" rel="prev" title="Set in golang">
                  <i class="fa fa-angle-left"></i> Set in golang
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/blog/fio-fsync-end_fsync-fdatasync-and-sync/" rel="next" title="Fio fsync, end_fsync, fdatasync and sync">
                  Fio fsync, end_fsync, fdatasync and sync <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">relentlesstorm</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
