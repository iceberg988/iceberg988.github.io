<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo/FlamingBytes-icon-64x64-1.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo/FlamingBytes-icon-64x64-1.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo/FlamingBytes-icon-64x64-1.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.flamingbytes.com","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Stay hungry, stay foolish">
<meta property="og:type" content="website">
<meta property="og:title" content="FlamingBytes">
<meta property="og:url" content="https://www.flamingbytes.com/page/26/index.html">
<meta property="og:site_name" content="FlamingBytes">
<meta property="og:description" content="Stay hungry, stay foolish">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="relentlesstorm">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.flamingbytes.com/page/26/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/26/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>FlamingBytes</title>
  







<!-- Google Adsense-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8578408127828851"
     crossorigin="anonymous"></script>

<!-- Google tag (gtag.js) for analytics-->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B8PQ47L2H0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B8PQ47L2H0');
</script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">FlamingBytes</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">10</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">104</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">279</span></a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="relentlesstorm"
      src="/images/logo/FlamingBytes-icon-64x64-1.png">
  <p class="site-author-name" itemprop="name">relentlesstorm</p>
  <div class="site-description" itemprop="description">Stay hungry, stay foolish</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">279</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">104</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="mailto:relentlesstorm@gmail.com" title="E-Mail → mailto:relentlesstorm@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/memory-mapped-i-o/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/memory-mapped-i-o/" class="post-title-link" itemprop="url">Memory-Mapped I/O</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-02-04 08:00:00" itemprop="dateCreated datePublished" datetime="2021-02-04T08:00:00-08:00">2021-02-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Memory-mapped I&#x2F;O lets us map a file on disk into a buffer in memory so that, when we fetch bytes from the buffer, the corresponding bytes of the file are read. Similarly, when we store data in the buffer, the corresponding bytes are automatically written to the file. This lets us perform I&#x2F;O without using read or write.</p>
<pre><code>#include &lt;sys/mman.h&gt;

void *mmap(void *addr, size_t len, int prot, int flag, int fd, off_t off );

Returns: starting address of mapped region if OK, MAP_FAILED on error
</code></pre>
<p>The addr argument lets us specify the address where we want the mapped region to start. We normally set this value to 0 to allow the system to choose the starting address. The return value of this function is the starting address of the mapped area.</p>
<p>The fd argument is the file descriptor specifying the file that is to be mapped. We have to open this file before we can map it into the address space. The len argument is the number of bytes to map, and off is the starting offset in the file of the bytes to map.</p>
<p>The prot argument specifies the protection of the mapped region.</p>
<pre><code>prot         Description
PROT_READ    Region can be read.
PROT_WRITE   Region can be written.
PROT_EXEC    Region can be executed.
PROT_NONE    Region cannot be accessed.
</code></pre>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li>Advanced Programming in the UNIX Environment</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/memory-fragmentation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/memory-fragmentation/" class="post-title-link" itemprop="url">Memory fragmentation</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-02-03 08:00:00" itemprop="dateCreated datePublished" datetime="2021-02-03T08:00:00-08:00">2021-02-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/Performance/" itemprop="url" rel="index"><span itemprop="name">Performance</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Memory-fragmentation"><a href="#Memory-fragmentation" class="headerlink" title="Memory fragmentation"></a>Memory fragmentation</h2><p>Memory page availability can be checked from &#x2F;proc&#x2F;buddyinfo as below.</p>
<pre><code>$  cat /proc/buddyinfo
Node 0, zone      DMA      1      0      1      0      1      1      1      0      1      1      3
Node 0, zone    DMA32   3342   2441   2138   5025   1871    236      3      0      0      0      0
Node 0, zone   Normal 143135   6057 150803   4005    330     62      1      0      0      0      0
</code></pre>
<p>If you see the system log message file(&#x2F;var&#x2F;log&#x2F;message) is reporting “kernel: nf_conntrack: falling back to vmalloc”, it highly indicates the memory is being fragmented.</p>
<p>Following command can be used to compact fragmented memory pages.</p>
<pre><code>echo 1 &gt; /proc/sys/vm/compact_memory
</code></pre>
<h2 id="extfrag-threshold"><a href="#extfrag-threshold" class="headerlink" title="extfrag_threshold"></a>extfrag_threshold</h2><p>This parameter affects whether the kernel will compact memory or direct</p>
<p>reclaim to satisfy a high-order allocation. The extfrag&#x2F;extfrag_index file in</p>
<p>debugfs shows what the fragmentation index for each order is in each zone in</p>
<p>the system. Values tending towards 0 imply allocations would fail due to lack</p>
<p>of memory, values towards 1000 imply failures are due to fragmentation and -1</p>
<p>implies that the allocation will succeed as long as watermarks are met.</p>
<p>The kernel will not compact memory in a zone if the fragmentation index is &lt;&#x3D; extfrag_threshold. The default value is 500.</p>
<p>Example output:</p>
<pre><code>$  sysctl -a | grep extfrag_threshold
vm.extfrag_threshold = 500

$  cd /sys/kernel/debug/extfrag/
$  ls
extfrag_index  unusable_index

$  cat unusable_index
Node 0, zone      DMA 0.000 0.000 0.000 0.001 0.001 0.009 0.018 0.035 0.035 0.035 0.173
Node 0, zone    DMA32 0.000 0.000 0.000 0.000 0.000 0.001 0.001 0.003 0.007 0.013 0.028
Node 0, zone   Normal 0.000 0.007 0.020 0.045 0.096 0.192 0.342 0.552 0.803 1.000 1.000
Node 1, zone   Normal 0.000 0.006 0.021 0.051 0.104 0.190 0.325 0.522 0.775 1.000 1.000

$  cat extfrag_index
Node 0, zone      DMA -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000
Node 0, zone    DMA32 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000
Node 0, zone   Normal -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 0.955 0.978
Node 1, zone   Normal -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 -1.000 0.956 0.978

$  cat /proc/buddyinfo
Node 0, zone      DMA      1      0      1      0      2      1      1      0      0      1      3
Node 0, zone    DMA32      7     10     13     15     11      8      9     10      8      9    309
Node 0, zone   Normal 1134904 1124019 975094 1027980 973525 755862 528091 316182 123744      0      0
Node 1, zone   Normal 864976 1041246 994760 895916 726438 565284 415625 266573 118000      0      0
</code></pre>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/sysctl/vm.txt">https://www.kernel.org/doc/Documentation/sysctl/vm.txt</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/memory-overcommit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/memory-overcommit/" class="post-title-link" itemprop="url">Memory overcommit</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-02-02 08:00:00" itemprop="dateCreated datePublished" datetime="2021-02-02T08:00:00-08:00">2021-02-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/Performance/" itemprop="url" rel="index"><span itemprop="name">Performance</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>The Linux kernel supports the following overcommit handling modes</p>
<p>0	-	Heuristic overcommit handling. Obvious overcommits of</p>
<p>address space are refused. Used for a typical system. It</p>
<p>ensures a seriously wild allocation fails while allowing</p>
<p>overcommit to reduce swap usage.  root is allowed to</p>
<p>allocate slightly more memory in this mode. This is the</p>
<p>default.</p>
<p>1	-	Always overcommit. Appropriate for some scientific</p>
<p>applications. Classic example is code using sparse arrays</p>
<p>and just relying on the virtual memory consisting almost</p>
<p>entirely of zero pages.</p>
<p>2	-	Don’t overcommit. The total address space commit</p>
<p>for the system is not permitted to exceed swap + a</p>
<p>configurable amount (default is 50%) of physical RAM.</p>
<p>Depending on the amount you use, in most situations</p>
<p>this means a process will not be killed while accessing</p>
<p>pages but will receive errors on memory allocation as</p>
<p>appropriate.</p>
<pre><code>    Useful for applications that want to guarantee their
    memory allocations will be available in the future
    without having to initialize every page.
</code></pre>
<p>The overcommit policy is set via the sysctl &#96;vm.overcommit_memory’.</p>
<p>The overcommit amount can be set via <code>vm.overcommit_ratio&#39; (percentage) or </code>vm.overcommit_kbytes’ (absolute value).</p>
<p>The current overcommit limit and amount committed are viewable in</p>
<p>&#x2F;proc&#x2F;meminfo as CommitLimit and Committed_AS respectively.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/kmalloc-and-vmalloc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/kmalloc-and-vmalloc/" class="post-title-link" itemprop="url">kmalloc and vmalloc</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-02-01 08:00:00" itemprop="dateCreated datePublished" datetime="2021-02-01T08:00:00-08:00">2021-02-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="kmalloc"><a href="#kmalloc" class="headerlink" title="kmalloc"></a>kmalloc</h2><p>The function allocates contiguous region in physical memory. It’s fast and doesn’t clear the allocated memory content.</p>
<p>kmalloc function is defined in <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/source/include/linux/slab.h#L538">include&#x2F;linux&#x2F;slab.h</a></p>
<pre><code>/**
 * kmalloc - allocate memory
 * @size: how many bytes of memory are required.
 * @flags: the type of memory to allocate.
 *
 * kmalloc is the normal method of allocating memory
 * for objects smaller than page size in the kernel.
 *
 * The allocated object address is aligned to at least ARCH_KMALLOC_MINALIGN
 * bytes. For @size of power of two bytes, the alignment is also guaranteed
 * to be at least to the size.
 *
 * The @flags argument may be one of the GFP flags defined at
 * include/linux/gfp.h and described at
 * :ref:`Documentation/core-api/mm-api.rst &lt;mm-api-gfp-flags&gt;`
 *
 * The recommended usage of the @flags is described at
 * :ref:`Documentation/core-api/memory-allocation.rst &lt;memory_allocation&gt;`
 *
 * Below is a brief outline of the most useful GFP flags
 *
 * %GFP_KERNEL
 *	Allocate normal kernel ram. May sleep.
 *
 * %GFP_NOWAIT
 *	Allocation will not sleep.
 *
 * %GFP_ATOMIC
 *	Allocation will not sleep.  May use emergency pools.
 *
 * %GFP_HIGHUSER
 *	Allocate memory from high memory on behalf of user.
 *
 * Also it is possible to set different flags by OR&#39;ing
 * in one or more of the following additional @flags:
 *
 * %__GFP_HIGH
 *	This allocation has high priority and may use emergency pools.
 *
 * %__GFP_NOFAIL
 *	Indicate that this allocation is in no way allowed to fail
 *	(think twice before using).
 *
 * %__GFP_NORETRY
 *	If memory is not immediately available,
 *	then give up at once.
 *
 * %__GFP_NOWARN
 *	If allocation fails, don&#39;t issue any warnings.
 *
 * %__GFP_RETRY_MAYFAIL
 *	Try really hard to succeed the allocation but fail
 *	eventually.
 */
static __always_inline void *kmalloc(size_t size, gfp_t flags)&#123;
      if (__builtin_constant_p(size)) &#123;
#ifndef CONFIG_SLOB
        unsigned int index;
#endif
        if (size &gt; KMALLOC_MAX_CACHE_SIZE)
            return kmalloc_large(size, flags);
#ifndef CONFIG_SLOB
        index = kmalloc_index(size);

        if (!index)
            return ZERO_SIZE_PTR;

        return kmem_cache_alloc_trace(
                kmalloc_caches[kmalloc_type(flags)][index],
                flags, size);
#endif
    &#125;
    return __kmalloc(size, flags);
&#125;
</code></pre>
<p>The first argument is the size of the blocks to be allocated. The second argument is the memory allocation type flags. It controls the behavior of kmalloc.</p>
<ul>
<li>GFP_KERNEL is the most commonly used flag. It means the allocation is performed on behalf of a process running in kernel space. kmalloc can put the current process to sleep while waiting for the page allocation if the system is in memory starvation. The free memory can be optained either by flushing buffer to disk or swapping out user process memory.</li>
<li>GFP_ATOMIC is used if the kmalloc call is from outside process context. The kernel can use the reserved free pages to serve the allocation. The allocation can fail if there is no last free page.</li>
</ul>
<h2 id="vmalloc"><a href="#vmalloc" class="headerlink" title="vmalloc"></a>vmalloc</h2><p>vmalloc allocates a contiguous memory region in the virtual address space. The allocated pages in physical memory are not consecutive and each page is retrieved with separate call to alloc_page. Thus, the vmalloc function is less efficient than kmalloc.</p>
<p>vmalloc function is defined in <a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/source/mm/vmalloc.c#L2650">mm&#x2F;vmalloc.c</a></p>
<pre><code>/**
 * vmalloc - allocate virtually contiguous memory
 * @size:    allocation size
 *
 * Allocate enough pages to cover @size from the page level
 * allocator and map them into contiguous kernel virtual space.
 *
 * For tight control over page level allocator and protection flags
 * use __vmalloc() instead.
 *
 * Return: pointer to the allocated memory or %NULL on error
 */
void *vmalloc(unsigned long size)
&#123;
    return __vmalloc_node(size, 1, GFP_KERNEL, NUMA_NO_NODE,
                __builtin_return_address(0));
&#125;
</code></pre>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.oreilly.com/library/view/linux-device-drivers/0596005903/ch08.html">https://www.oreilly.com/library/view/linux-device-drivers/0596005903/ch08.html</a></li>
<li><a target="_blank" rel="noopener" href="https://elixir.bootlin.com/linux/latest/source/include/linux/slab.h#L538">https://elixir.bootlin.com/linux/latest/source/include/linux/slab.h#L538</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/cooking-masters/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/cooking-masters/" class="post-title-link" itemprop="url">Cooking Masters</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-01-16 07:49:00" itemprop="dateCreated datePublished" datetime="2021-01-16T07:49:00-08:00">2021-01-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Young-Author/" itemprop="url" rel="index"><span itemprop="name">Young Author</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>It was my most regrettable decision ever. I was playing with Alex, who was my next door neighbor and my best friend in fourth grade. Suddenly, Alex said: “You know what, I think it’s time for us to compare our cooking skills now that I practiced my recipes for two years now.”  I did not know what to say. I knew Alex was teasing me. He had enrolled for a master cooking class and practiced for two years already. I was only a home cook, and I never thought about entering a cooking competition. I wanted to decline the offer but that would show that I was afraid. I did not like people calling me a loser so I foolishly accepted the challenge. We decided we were going to hold the cooking contest in my school’s cafeteria.</p>
<p>When I told my parents about the contest, they said that I should cook something really fancy so it will increase my chance of winning. I got really stressed then. I only knew one type of dish which was a burger. I knew how to make many kinds of burgers but nothing else. I decided to go online to search up some recipes for other foods. I bought the ingredients and started to try new recipes. But none of them tasted better than my masterpiece burger.</p>
<p>I wondered if I was doing something wrong. The recipes were more complicated so they should taste better. But they didn’t. I told my mom that I did not think the new dishes tasted any better than my burger. She said that I should be patient and practice more. I disagreed with her. I only had a few days to practice and mastering new recipes would take me weeks. I decided to continue with my burger. I was best at making that so it should have the highest chance of winning the contest. I created new kinds of burgers everyday from then on and tasted each of them to see if they were the best I could make.</p>
<p>Then, on the day before the contest, my mom asked me what dish I prepared. When I told her I was going to make a burger, she advised me that next time I should make a more complicated recipe. “A tasty recipe matters on how delicious it is, not how fancy or complicated it is.” I said. Even if many people think a burger would not stand a chance against a chocolate cake, I refused to change my topic.</p>
<p>Finally, the day of the competition arrived. I entered the stadium and put my ingredients on the right side of the table. I felt the tension in the kitchen. Alex was there and he was sitting on the left side of the table. When he saw that I had only a few ingredients needed to make my dish, he asked me what I was going to cook. A confident smile grew on his face when I told him I was going to make a smash burger. He told me I could forfeit if I was scared. I stared at him. I knew what he was going for. But it was not so easy to make me give up. Seeing that I would not back up, Alex had no choice but to start a cooking fight with me. Then the competition began. I first carefully spread some butter on the brioche buns. Then I toasted the buns. I took out the ground beef and rolled it into a patty. Meanwhile, Alex was making a chocolate cake. I wondered if the judge would like salty or sweet food better. While I was thinking, the judge said that we had thirty minutes left. I continued to make my Bacon King smash burger.</p>
<p>I could feel my heart beating fast. I shakily put the patty into the pan and fried them. I then put the juicy meat on the toasted bun. Alex was watching me the whole time. He was already done baking his cake. I felt a thousand pairs of eyes looking at me. There was no time to be nervous. I put the butter lettuce on the meat and assembled the burger.</p>
<p>Alex looked toward me. “It is no use trying to act tough. A loser will always remain a loser,” he said. But I ignored his words.</p>
<p>Then we presented our finished results to the judge. He first took a bite out of the chocolate cake. He said that the sweetness of the chocolate cake mixed with the sourness of the strawberry on top was perfect. Then he ate my burger. He did not say anything. Cold sweat fell on my face. The whole room was so quiet that you could hear a pin drop on the ground.</p>
<p>I gulped. Did the judge dislike my burger? That was when I saw him take another bite out of the burger. After that, he looked at Alex and me. “Well?” said Alex impatiently. “Who won?” The judge stood up. He said it was very hard to decide which recipe was tastier than the other. Though he equally liked the two foods, he said that my burger had the perfect attributes a burger should have. I grinned because I knew I won the contest.</p>
<p>If I had made a fancy unfamiliar recipe, I may have never won this contest. I learnt that we should always play to our strengths and do what we are good at.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/art-sketch-2021/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/art-sketch-2021/" class="post-title-link" itemprop="url">Art - Sketch 2021</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-01-02 08:00:00" itemprop="dateCreated datePublished" datetime="2021-01-02T08:00:00-08:00">2021-01-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Young-Author/" itemprop="url" rel="index"><span itemprop="name">Young Author</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/images/drawing/IMG_0341.jpeg"></p>
<p><img src="/images/drawing/IMG_0380.jpeg"></p>
<p><img src="/images/drawing/IMG_0381-1.jpeg"></p>
<p><img src="/images/drawing/IMG_20210919_134430.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134437.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134444.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134454.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134503.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134509.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134516.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134520.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134525.jpg"></p>
<hr>
<p><img src="/images/drawing/IMG_20210919_134531.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134536.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134541.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134548.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134556.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134600.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134612.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_134617.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135038.jpg"></p>
<hr>
<p><img src="/images/drawing/IMG_20210919_135114.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135134.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135140.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135148.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135209.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135216.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135248.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135259.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135305.jpg"></p>
<hr>
<p><img src="/images/drawing/IMG_20210919_135323.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135334.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135420.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135442.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135453.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135502.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135534.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135543.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135603.jpg"></p>
<hr>
<p><img src="/images/drawing/IMG_20210919_135607.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135630.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135707.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135718.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135726.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135734.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135753.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135802.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135825.jpg"></p>
<hr>
<p><img src="/images/drawing/IMG_20210919_135837.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135856.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135903.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135914.jpg"></p>
<p><img src="/images/drawing/IMG_20210919_135920.jpg"></p>
<p><img src="/images/drawing/IMG_20211125_171239__01.jpg"></p>
<p><img src="/images/drawing/IMG_20211231_201653__01.jpg"></p>
<p><img src="/images/drawing/mmexport1632282808724.jpg"></p>
<p><img src="/images/drawing/mmexport1632282830539.jpg"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/useful-hba-commands/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/useful-hba-commands/" class="post-title-link" itemprop="url">Useful HBA commands</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-10 08:00:00" itemprop="dateCreated datePublished" datetime="2020-11-10T08:00:00-08:00">2020-11-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Check-HBA-card-type"><a href="#Check-HBA-card-type" class="headerlink" title="Check HBA card type"></a>Check HBA card type</h2><pre><code>$  lspci | grep -i fibre
18:00.0 Fibre Channel: QLogic Corp. ISP2722-based 16/32Gb Fibre Channel to PCIe Adapter (rev 01)
18:00.1 Fibre Channel: QLogic Corp. ISP2722-based 16/32Gb Fibre Channel to PCIe Adapter (rev 01)
</code></pre>
<h2 id="Physical-slot-driver-module-information"><a href="#Physical-slot-driver-module-information" class="headerlink" title="Physical slot, driver, module information"></a>Physical slot, driver, module information</h2><pre><code>$  lspci -v -s 18:00.0
18:00.0 Fibre Channel: QLogic Corp. ISP2722-based 16/32Gb Fibre Channel to PCIe Adapter (rev 01)
    Subsystem: QLogic Corp. QLE2692 Dual Port 16Gb Fibre Channel to PCIe Adapter
    Flags: bus master, fast devsel, latency 0, IRQ 231, NUMA node 0
    Memory at aab05000 (64-bit, prefetchable) [size=4K]
    Memory at aab02000 (64-bit, prefetchable) [size=8K]
    Memory at aaa00000 (64-bit, prefetchable) [size=1M]
    Expansion ROM at 9d900000 [disabled] [size=256K]
    Capabilities: [44] Power Management version 3
    Capabilities: [4c] Express Endpoint, MSI 00
    Capabilities: [88] Vital Product Data
    Capabilities: [90] MSI-X: Enable+ Count=16 Masked-
    Capabilities: [9c] Vendor Specific Information: Len=0c &lt;?&gt;
    Capabilities: [100] Advanced Error Reporting
    Capabilities: [154] Alternative Routing-ID Interpretation (ARI)
    Capabilities: [1c0] #19
    Capabilities: [1f4] Vendor Specific Information: ID=0001 Rev=1 Len=014 &lt;?&gt;
    Kernel driver in use: qla2xxx
    Kernel modules: qla2xxx
</code></pre>
<h2 id="Check-if-the-driver-module-loaded"><a href="#Check-if-the-driver-module-loaded" class="headerlink" title="Check if the driver&#x2F;module loaded"></a>Check if the driver&#x2F;module loaded</h2><pre><code>$  lsmod | grep qla2xxx
qla2xxx               792059  246
nvme_fc                33640  1 qla2xxx
scsi_transport_fc      64007  1 qla2xxx
</code></pre>
<h2 id="Check-module-file-name"><a href="#Check-module-file-name" class="headerlink" title="Check module file name"></a>Check module file name</h2><pre><code>$  modinfo -n qla2xxx
/lib/modules/3.10.0-1062.12.1.el7.x86_64/kernel/drivers/scsi/qla2xxx/qla2xxx.ko
</code></pre>
<h2 id="Check-HBA-driver-and-version"><a href="#Check-HBA-driver-and-version" class="headerlink" title="Check HBA driver and version"></a>Check HBA driver and version</h2><pre><code>$  modinfo -d qla2xxx
QLogic Fibre Channel HBA Driver
QLogic Fibre Channel HBA Driver (Target Mode Support, including 24xx+ ISP)

$  modinfo qla2xxx | grep version
version:        8.07.00.34.Trunk-SCST.19-k
rhelversion:    7.7
srcversion:     B6770D64FCF8A0A0273AD2C
vermagic:       3.10.0-1062.12.1.el7.x86_64 SMP mod_unload modversions
</code></pre>
<h2 id="Check-if-the-running-driver-is-same-as-kernel"><a href="#Check-if-the-running-driver-is-same-as-kernel" class="headerlink" title="Check if the running driver is same as kernel"></a>Check if the running driver is same as kernel</h2><pre><code>$  modinfo -k `uname -r` -n qla2xxx
/lib/modules/3.10.0-1062.12.1.el7.x86_64/kernel/drivers/scsi/qla2xxx/qla2xxx.ko
</code></pre>
<h2 id="Remove-current-module-driver"><a href="#Remove-current-module-driver" class="headerlink" title="Remove current module&#x2F;driver"></a>Remove current module&#x2F;driver</h2><pre><code>$  modprobe -r qla2xxx
</code></pre>
<h2 id="Show-dependent-devices-modules"><a href="#Show-dependent-devices-modules" class="headerlink" title="Show dependent devices&#x2F;modules"></a>Show dependent devices&#x2F;modules</h2><pre><code>$  modprobe --show-depends qla2xxx
insmod /lib/modules/3.10.0-1062.12.1.el7.x86_64/kernel/drivers/scsi/scsi_tgt.ko.xz
insmod /lib/modules/3.10.0-1062.12.1.el7.x86_64/kernel/drivers/scsi/scsi_transport_fc.ko.xz
insmod /lib/modules/3.10.0-1062.12.1.el7.x86_64/kernel/drivers/scsi/qla2xxx/qla2xxx.ko ql2xfwloadbin=2
</code></pre>
<h2 id="Check-the-available-HBA-ports"><a href="#Check-the-available-HBA-ports" class="headerlink" title="Check the available HBA ports"></a>Check the available HBA ports</h2><pre><code>$  ls -l /sys/class/fc_host
total 0
lrwxrwxrwx. 1 root root 0 Mar  9 13:01 host2 -&gt; ../../devices/pci0000:17/0000:17:00.0/0000:18:00.0/host2/fc_host/host2
lrwxrwxrwx. 1 root root 0 Mar  9 13:01 host3 -&gt; ../../devices/pci0000:17/0000:17:00.0/0000:18:00.1/host3/fc_host/host3
</code></pre>
<h2 id="View-used-HBA-ports-on-server"><a href="#View-used-HBA-ports-on-server" class="headerlink" title="View used HBA ports on server"></a>View used HBA ports on server</h2><pre><code>$  ls -ltr /sys/class/fc_transport/
total 0
lrwxrwxrwx. 1 root root 0 Mar  9 13:01 target6:0:0 -&gt; ../../devices/pci0000:85/0000:85:02.0/0000:87:00.0/host6/rport-6:0-0/target6:0:0/fc_transport/target6:0:0
lrwxrwxrwx. 1 root root 0 Mar  9 13:01 target4:0:0 -&gt; ../../devices/pci0000:85/0000:85:00.0/0000:86:00.0/host4/rport-4:0-0/target4:0:0/fc_transport/target4:0:0
[...]
</code></pre>
<h2 id="Find-the-WWN-numbers-for-your-fc-host"><a href="#Find-the-WWN-numbers-for-your-fc-host" class="headerlink" title="Find the WWN numbers for your fc host"></a>Find the WWN numbers for your fc host</h2><pre><code>$  cat /sys/class/fc_host/host?/port_name
0x210034800d6baa70
0x210034800d6baa71
</code></pre>
<h2 id="Port-state"><a href="#Port-state" class="headerlink" title="Port state"></a>Port state</h2><pre><code>$  cat /sys/class/fc_host/host?/port_state
Online
Online
</code></pre>
<h2 id="Queue-depth"><a href="#Queue-depth" class="headerlink" title="Queue depth"></a>Queue depth</h2><pre><code>$  cat /sys/module/qla2xxx/parameters/ql2xmaxqdepth
64
</code></pre>
<p>To set&#x2F;change the qdepth value on the fly:</p>
<pre><code>$ echo 16 &gt; /sys/module/qla2xxx/parameters/ql2xmaxqdepth
</code></pre>
<p>To set the qdepth value permanently:</p>
<pre><code>$ modinfo qla2xxx | grep ql2xmaxqdepth
parm: ql2xmaxqdepth:Maximum queue depth to set for each LUN. Default is 32. (int)

$ vi /etc/modprobe.conf
alias scsi_hostadapter1 qla2xxx
options qla2xxx ql2xmaxqdepth=16
</code></pre>
<h2 id="Scan-disks"><a href="#Scan-disks" class="headerlink" title="Scan disks"></a>Scan disks</h2><pre><code>$  ls /sys/class/scsi_host
host1  host2  host3  host4  host5  host6  host7

$  for x in `ls /sys/class/scsi_host`
&gt; do
&gt; echo &quot;- - -&quot; &gt; /sys/class/scsi_host/$x/scan
&gt; done
</code></pre>
<h2 id="Check-number-of-LUNs"><a href="#Check-number-of-LUNs" class="headerlink" title="Check number of LUNs"></a>Check number of LUNs</h2><pre><code>$  pwd
/opt/QLogic_Corporation/QConvergeConsoleCLI

$ ./scli -t 
HBA Instance 1: QLE2692 Port 2 WWPN 21-00-34-80-0D-6B-AA-71 PortID 02-1D-00
Link: Online

Path                           : 0
Target                         : 0
Device ID                      : 0xffff
Product Vendor                 : PURE
Product ID                     : FlashArray
Product Revision               : 8888
Serial Number                  : 7CA43045E3514BF700011025
Node Name                      : 52-4A-93-77-BB-B4-74-03
Port Name                      : 52-4A-93-77-BB-B4-74-03
Port ID                        : 02-2C-00
Product Type                   : FCP Disk
LUN Count(s)                   : 16
Status                         : Online
</code></pre>
<h2 id="Check-HBA-speed"><a href="#Check-HBA-speed" class="headerlink" title="Check HBA speed"></a>Check HBA speed</h2><pre><code>$  grep -Hv &quot;zz&quot; /sys/class/fc_host/host*/speed
/sys/class/fc_host/host2/speed:16 Gbit
/sys/class/fc_host/host3/speed:16 Gbit
</code></pre>
<h2 id="Collect-QLogic-HBA-stats"><a href="#Collect-QLogic-HBA-stats" class="headerlink" title="Collect QLogic HBA stats"></a>Collect QLogic HBA stats</h2><pre><code>$  pwd
/opt/QLogic_Corporation/QConvergeConsoleCLI

$  ./qaucli -gs 8 SetRate 10 LogToFile /tmp/fs.stat.csv
</code></pre>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://linoxide.com/storage/scandetect-luns-redhat-linux-outputs-remember/">https://linoxide.com/storage/scandetect-luns-redhat-linux-outputs-remember/</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/monitor-rman-backup-and-restore-progress/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/monitor-rman-backup-and-restore-progress/" class="post-title-link" itemprop="url">Monitor RMAN backup and restore progress</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-09 08:00:00" itemprop="dateCreated datePublished" datetime="2020-11-09T08:00:00-08:00">2020-11-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/Big-Data/" itemprop="url" rel="index"><span itemprop="name">Big Data</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>The following script will allow you to monitor progress of an RMAN backup or Restore from 4 different perspectives (channel, session wait events, datafiles, backuppieces). The script is run from SQLPlus and takes a date input value in the format ‘dd-mon-rr hh24:mi:ss’. The date supplied does not have to be precise and can be taken from the rman log of the job that is running.</p>
<pre><code>REM 
REM Script to monitor rman backup/restore operations
REM To run from sqlplus:   @monitor &#39;[dd-mon-rr hh24:mi:ss]&#39; 
REM Example:  
--SQL&gt;spool monitor.out
--SQL&gt;@monitor &#39;06-aug-12 16:38:03&#39;
REM where [date] is the start time of your rman backup or restore job
REM Run monitor script periodically to confirm rman is progessing
REM 

alter session set nls_date_format=&#39;dd-mon-rr hh24:mi:ss&#39;;
set lines 1500
set pages 100
col CLI_INFO format a10
col spid format a5
col ch format a20
col seconds format 999999.99
col filename format a65
col bfc  format 9
col &quot;% Complete&quot; format 999.99
col event format a40
set numwidth 10

select sysdate from dual;

REM gv$session_longops (channel level)

prompt
prompt Channel progress - gv$session_longops:
prompt
select s.inst_id, o.sid, CLIENT_INFO ch, context, sofar, totalwork,
                    round(sofar/totalwork*100,2) &quot;% Complete&quot;
     FROM gv$session_longops o, gv$session s
     WHERE opname LIKE &#39;RMAN%&#39;
     AND opname NOT LIKE &#39;%aggregate%&#39;
     AND o.sid=s.sid
     AND totalwork != 0
     AND sofar &lt;&gt; totalwork;

REM Check wait events (RMAN sessions) - this is for CURRENT waits only
REM use the following for 11G+
prompt
prompt Session progess - CURRENT wait events and time in wait so far:
prompt
select inst_id, sid, CLIENT_INFO ch, seq#, event, state, wait_time_micro/1000000 seconds
from gv$session where program like &#39;%rman%&#39; and
wait_time = 0 and
not action is null;

REM use the following for 10G
--select  inst_id, sid, CLIENT_INFO ch, seq#, event, state, seconds_in_wait secs
--from gv$session where program like &#39;%rman%&#39; and
--wait_time = 0 and
--not action is null;

REM gv$backup_async_io
prompt
prompt Disk (file and backuppiece) progress - includes tape backuppiece 
prompt if backup_tape_io_slaves=TRUE:
prompt
select s.inst_id, a.sid, CLIENT_INFO Ch, a.STATUS,
open_time, round(BYTES/1024/1024,2) &quot;SOFAR Mb&quot; , round(total_bytes/1024/1024,2)
TotMb, io_count,
round(BYTES/TOTAL_BYTES*100,2) &quot;% Complete&quot; , a.type, filename
from gv$backup_async_io a,  gv$session s
where not a.STATUS in (&#39;UNKNOWN&#39;)
and a.sid=s.sid and open_time &gt; to_date(&#39;&amp;1&#39;, &#39;dd-mon-rr hh24:mi:ss&#39;) order by 2,7;

REM gv$backup_sync_io
prompt
prompt Tape backuppiece progress (only if backup_tape_io_slaves=FALSE):
prompt
select s.inst_id, a.sid, CLIENT_INFO Ch, filename, a.type, a.status, buffer_size bsz, buffer_count bfc,
open_time open, io_count
from gv$backup_sync_io a, gv$session s
where
a.sid=s.sid and
open_time &gt; to_date(&#39;&amp;1&#39;, &#39;dd-mon-rr hh24:mi:ss&#39;) ;
REM 
</code></pre>
<p>From RMAN log, you can see the follwoing timestamp.</p>
<p><em>Starting restore at 16-DEC-2019 12:38:04</em></p>
<p>You can run this script at any time if you suspect that rman is taking longer than expected - simply spool the results to a file and rerun the script periodically to check that the job is progressing.</p>
<p>Sample output:</p>
<pre><code>$ sqlplus / as sysdba

SQL*Plus: Release 12.2.0.1.0 Production on Mon Dec 16 14:08:34 2019
Copyright (c) 1982, 2016, Oracle.  All rights reserved.
Connected to:
Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production

SQL&gt; @monitor &quot;16-DEC-2019 12:38:04&quot;
Session altered.


SYSDATE
16-dec-19 14:08:45


Channel progress - gv$session_longops:
no rows selected

Session progess - CURRENT wait events and time in wait so far:

   INST_ID	  SID CH			 SEQ# EVENT				       STATE		      SECONDS

     1	  217				35823 SQL*Net message from client	       WAITING		       115.75
     1	  225 rman channel=ch00 	 3647 Backup: MML restore backup piece	       WAITING		       115.94
     1	  229 rman channel=ch01 	32765 Backup: MML restore backup piece	       WAITING		       115.88
     1	  233 rman channel=ch02 	51706 Backup: MML restore backup piece	       WAITING		       115.81
     1	  237 rman channel=ch03 	62302 Backup: MML restore backup piece	       WAITING		       115.75

Disk (file and backuppiece) progress - includes tape backuppiece
if backup_tape_io_slaves=TRUE:

old   7: and a.sid=s.sid and open_time &gt; to_date(&#39;&amp;1&#39;, &#39;dd-mon-rr hh24:mi:ss&#39;) order by 2,7
new   7: and a.sid=s.sid and open_time &gt; to_date(&#39;16-DEC-2019 12:38:04&#39;, &#39;dd-mon-rr hh24:mi:ss&#39;) order by 2,7

   INST_ID	  SID CH		   STATUS      OPEN_TIME	    SOFAR Mb	  TOTMB   IO_COUNT % Complete TYPE	FILENAME

     1	  225 rman channel=ch00    FINISHED    16-dec-19 13:03:03	  31	     31 	 9     100.00 OUTPUT	+DATA/tpcc/iitem_0_0
     1	  225 rman channel=ch00    FINISHED    16-dec-19 12:47:56      31900	  31900       7977     100.00 OUTPUT	+DATA/tpcc/hist_0_0
     1	  229 rman channel=ch01    FINISHED    16-dec-19 12:57:30      30600	  30600       7652     100.00 OUTPUT	+DATA/tpcc/stok_0_6
     1	  229 rman channel=ch01    FINISHED    16-dec-19 12:53:37      30890	  30890       7724     100.00 OUTPUT	+DATA/tpcc/ordr_0_9
     1	  229 rman channel=ch01    FINISHED    16-dec-19 12:50:21      31280	  31280       7822     100.00 OUTPUT	+DATA/tpcc/cust_0_6
     1	  233 rman channel=ch02    FINISHED    16-dec-19 13:02:39	  90	     90 	24     100.00 OUTPUT	+DATA/tpcc/ware_0_0
     1	  233 rman channel=ch02    FINISHED    16-dec-19 13:01:49	 933	    933        235     100.00 OUTPUT	+DATA/tpcc/tpccaux
     1	  233 rman channel=ch02    FINISHED    16-dec-19 12:58:16      30600	  30600       7652     100.00 OUTPUT	+DATA/tpcc/stok_0_11
     1	  233 rman channel=ch02    FINISHED    16-dec-19 12:55:07      30890	  30890       7724     100.00 OUTPUT	+DATA/tpcc/ordr_0_14
     1	  233 rman channel=ch02    FINISHED    16-dec-19 12:51:07      30890	  30890       7724     100.00 OUTPUT	+DATA/tpcc/ordr_0_4
     1	  237 rman channel=ch03    FINISHED    16-dec-19 13:02:48      33.21	  33.21 	10     100.00 OUTPUT	+DATA/tpcc/iware_0_0
     1	  237 rman channel=ch03    FINISHED    16-dec-19 13:01:59	 400	    400        102     100.00 OUTPUT	+DATA/tpcc/system_1
     1	  237 rman channel=ch03    FINISHED    16-dec-19 13:00:34    7490.45	7490.45       1874     100.00 OUTPUT	+DATA/tpcc/icust1_0_0
     1	  237 rman channel=ch03    FINISHED    16-dec-19 12:55:15      30600	  30600       7652     100.00 OUTPUT	+DATA/tpcc/stok_0_0
     1	  237 rman channel=ch03    FINISHED    16-dec-19 12:53:02      30890	  30890       7724     100.00 OUTPUT	+DATA/tpcc/ordr_0_8
     1	  237 rman channel=ch03    FINISHED    16-dec-19 12:48:06      31280	  31280       7822     100.00 OUTPUT	+DATA/tpcc/cust_0_1

16 rows selected.

Tape backuppiece progress (only if backup_tape_io_slaves=FALSE):

old   6: open_time &gt; to_date(&#39;&amp;1&#39;, &#39;dd-mon-rr hh24:mi:ss&#39;)
new   6: open_time &gt; to_date(&#39;16-DEC-2019 12:38:04&#39;, &#39;dd-mon-rr hh24:mi:ss&#39;)

   INST_ID	  SID CH		   FILENAME							     TYPE      STATUS		  BSZ BFC OPEN		       IO_COUNT

     1	  225 rman channel=ch00    bk_dTPCC_ucuuj5dpp_s414_p1_t1026733881			     INPUT     FINISHED        262144	4 16-dec-19 12:47:56	  65392
     1	  225 rman channel=ch00    bk_dTPCC_uehuj5udh_s465_p1_t1026750897			     INPUT     FINISHED        262144	4 16-dec-19 13:03:03	      8
     1	  229 rman channel=ch01    bk_dTPCC_ud7uj5i8g_s423_p1_t1026738448			     INPUT     FINISHED        262144	4 16-dec-19 12:50:21	 116172
     1	  229 rman channel=ch01    bk_dTPCC_udtuj5q1d_s445_p1_t1026746413			     INPUT     FINISHED        262144	4 16-dec-19 12:57:30	 113036
     1	  229 rman channel=ch01    bk_dTPCC_udhuj5l9e_s433_p1_t1026741550			     INPUT     FINISHED        262144	4 16-dec-19 12:53:37	  63372
     1	  233 rman channel=ch02    bk_dTPCC_ueeuj5u99_s462_p1_t1026750761			     INPUT     FINISHED        262144	4 16-dec-19 13:02:39	    312
     1	  233 rman channel=ch02    bk_dTPCC_udmuj5mm0_s438_p1_t1026742976			     INPUT     FINISHED        262144	4 16-dec-19 12:55:07	  63776
     1	  233 rman channel=ch02    bk_dTPCC_ue0uj5rik_s448_p1_t1026747988			     INPUT     FINISHED        262144	4 16-dec-19 12:58:16	 113444
     1	  233 rman channel=ch02    bk_dTPCC_ueauj5u3a_s458_p1_t1026750570			     INPUT     FINISHED        262144	4 16-dec-19 13:01:49	   3220
     1	  233 rman channel=ch02    bk_dTPCC_udauj5jb1_s426_p1_t1026739553			     INPUT     FINISHED        262144	4 16-dec-19 12:51:07	  64180
     1	  237 rman channel=ch03    bk_dTPCC_ueguj5uc3_s464_p1_t1026750851			     INPUT     FINISHED        262144	4 16-dec-19 13:02:48	      0
     1	  237 rman channel=ch03    bk_dTPCC_uecuj5u6f_s460_p1_t1026750671			     INPUT     FINISHED        262144	4 16-dec-19 13:01:59	   1184
     1	  237 rman channel=ch03    bk_dTPCC_ue7uj5trl_s455_p1_t1026750325			     INPUT     FINISHED        262144	4 16-dec-19 13:00:34	  28188
     1	  237 rman channel=ch03    bk_dTPCC_udnuj5mut_s439_p1_t1026743261			     INPUT     FINISHED        262144	4 16-dec-19 12:55:15	 113444
     1	  237 rman channel=ch03    bk_dTPCC_udfuj5knj_s431_p1_t1026740979			     INPUT     FINISHED        262144	4 16-dec-19 12:53:02	  63372
     1	  237 rman channel=ch03    bk_dTPCC_ud1uj5f5c_s417_p1_t1026735276			     INPUT     FINISHED        262144	4 16-dec-19 12:48:06	 115768

16 rows selected.
</code></pre>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.thegeekdiary.com/script-to-monitor-rman-backup-and-restore-operations/">https://www.thegeekdiary.com/script-to-monitor-rman-backup-and-restore-operations/</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/rman-backup-set-pieces-and-datafiles/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/rman-backup-set-pieces-and-datafiles/" class="post-title-link" itemprop="url">RMAN backup set, pieces, and datafiles</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-08 08:00:00" itemprop="dateCreated datePublished" datetime="2020-11-08T08:00:00-08:00">2020-11-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Tech/Big-Data/" itemprop="url" rel="index"><span itemprop="name">Big Data</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>RMAN backs up the datafiles, control file, archived log files, and server parameter files in a RMAN specific format called a backup piece. In a nutshell, a backup set is a bundle of dbf, ctl and redo file that can restore a database. A set of one or more such backup pieces makes up a backup set. A backup set is created using the BACKUP command.</p>
<h2 id="Useful-views-for-backup-query"><a href="#Useful-views-for-backup-query" class="headerlink" title="Useful views for backup query"></a>Useful views for backup query</h2><ul>
<li><p>V$BACKUP_SET displays information about backup sets from the control file. A backup set record is inserted after the backup set is successfully completed. The backup set stamp (SET_STAMP) and count (SET_COUNT) uniquely identify the backup set.</p>
</li>
<li><p>V$BACKUP_PIECE displays information about backup pieces from the control file. Each backup set consists of one or more backup pieces.</p>
</li>
<li><p>V$BACKUP_DATAFILE displays information about control files and datafiles in backup sets from the control file.</p>
</li>
<li><p>V$BACKUP_FILES displays information about all RMAN backups (both image copies and backup sets) and archived logs.This view simulates the LIST BACKUP and LIST COPY RMAN commands. This view requires that the database be set using the DBMS_RCVMAN.SETDATABASE procedure.</p>
</li>
</ul>
<h2 id="Useful-SQL-statements"><a href="#Useful-SQL-statements" class="headerlink" title="Useful SQL statements"></a>Useful SQL statements</h2><ul>
<li><p>Query backup set information. The very last record(e.g. RECID&#x3D;360) could be used as the start point for future queries.</p>
<p>  SQL&gt; select recid, set_stamp, set_count, backup_type,incremental_level,pieces,start_time,completion_time,elapsed_seconds,block_size from v$backup_set;</p>
</li>
</ul>
<p><img src="/images/rman01.png" alt="Image"></p>
<ul>
<li><p>Query backup pieces for certain backup set.</p>
<p>  SQL&gt; select piece#,compressed,start_time,completion_time,elapsed_seconds,bytes&#x2F;1024&#x2F;1024 from v$backup_piece where set_stamp&#x3D;1029939968 and set_count&#x3D;372;</p>
</li>
</ul>
<p><img src="/images/rman02.png" alt="Image"></p>
<ul>
<li><p>Query backup files for certain backup set.</p>
<p>  SQL&gt; select pkey,fname,file_type,bytes&#x2F;1024&#x2F;1024,bs_key,bs_type,bs_pieces,bs_incr_type,bs_bytes&#x2F;1024&#x2F;1024, bs_completion_time from v$backup_files where FILE_TYPE&#x3D;’PIECE’order by bs_key;</p>
</li>
</ul>
<p><img src="/images/rman03.png" alt="Image"></p>
<pre><code>SQL&gt; select pkey,file_type, fname, bytes/1024/1024,bs_key,bs_type,bs_incr_type,bs_bytes/1024/1024 from v$backup_files where bs_key=360;
</code></pre>
<p><img src="/images/rman04.png" alt="Image"></p>
<ul>
<li><p>Query total blocks and read blocks for certain backup set.</p>
<p>  SQL&gt; select set_stamp,set_count,incremental_level,datafile_blocks,blocks,block_size, CREATION_TIME ,completion_time,used_change_tracking,blocks_read from v$backup_datafile where set_count&gt;365;</p>
</li>
</ul>
<p><img src="/images/rman05.png" alt="Image"></p>
<ul>
<li><p>Query total blocks and read blocks for certain backup. The following example checks the read and write ratio when BCT is enabled and a full backup is done.</p>
<p>  SQL&gt; select sum(BLOCKS_READ*BLOCK_SIZE)&#x2F;1024&#x2F;1024&#x2F;1024 read_GB from v$backup_datafile where USED_CHANGE_TRACKING &#x3D; ‘YES’;</p>
<p>  READ_GB<br>  1195.7244</p>
<p>  SQL&gt; select sum(BLOCKS*BLOCK_SIZE)&#x2F;1024&#x2F;1024&#x2F;1024 write_GB from v$backup_datafile where USED_CHANGE_TRACKING &#x3D; ‘YES’;</p>
<pre><code>WRITE_GB
</code></pre>
<p>  898.733315</p>
<p>  SQL&gt; select sum(DATAFILE_BLOCKS*BLOCK_SIZE)&#x2F;1024&#x2F;1024&#x2F;1024 datafile_GB from v$backup_datafile where USED_CHANGE_TRACKING &#x3D; ‘YES’;</p>
<p>  DATAFILE_GB<br>  1195.7244</p>
<p>  SQL&gt; select sum(BLOCKS_READ)&#x2F;sum(DATAFILE_BLOCKS) from v$backup_datafile where USED_CHANGE_TRACKING &#x3D; ‘YES’;</p>
<p>  SUM(BLOCKS_READ)&#x2F;SUM(DATAFILE_BLOCKS)<br>1<br>  SQL&gt; select sum(BLOCKS)&#x2F;sum(DATAFILE_BLOCKS) from v$backup_datafile where USED_CHANGE_TRACKING &#x3D; ‘YES’;</p>
<p>  SUM(BLOCKS)&#x2F;SUM(DATAFILE_BLOCKS)<br>.751622457</p>
</li>
<li><p>The following example checks the read and write blocks ratio after incremental backup is done which is based on previous full backup. The write blocks ratio can be treated as data change ratio.</p>
<p>  $ cat bct_check.sql<br>  set linesize 500;</p>
<p>  select set_stamp,set_count,incremental_level, used_change_tracking,blocks_read,blocks,datafile_blocks,block_size from v$backup_datafile where set_count&gt;372 order by set_count;</p>
<p>  select sum(BLOCKS_READ*BLOCK_SIZE)&#x2F;1024&#x2F;1024&#x2F;1024 read_GB from v$backup_datafile where set_count&gt;372;</p>
<p>  select sum(BLOCKS*BLOCK_SIZE)&#x2F;1024&#x2F;1024&#x2F;1024 write_GB from v$backup_datafile where set_count&gt;372;</p>
<p>  select sum(DATAFILE_BLOCKS*BLOCK_SIZE)&#x2F;1024&#x2F;1024&#x2F;1024 total_GB from v$backup_datafile where set_count&gt;372;</p>
<p>  select sum(BLOCKS_READ)&#x2F;sum(DATAFILE_BLOCKS) “%READ” from v$backup_datafile where set_count&gt;372;</p>
<p>  select sum(BLOCKS)&#x2F;sum(DATAFILE_BLOCKS) “%WRITE” from v$backup_datafile where set_count&gt;372;</p>
<p>  exit</p>
</li>
</ul>
<p>$ sqlplus &#x2F; as sysdba @bct_check.sql</p>
<p><img src="/images/rman06.png" alt="Image"></p>
<pre><code>READ_GB
662.855164

WRITE_GB
103.244957

TOTAL_GB
1195.75419

%READ
.554337382

%WRITE
.086336245
</code></pre>
<ul>
<li><p>The following command also checks total write data during backup.</p>
<p>  SQL&gt; select sum(BYTES)&#x2F;1024&#x2F;1024&#x2F;1024 from v$backup_piece where set_count&gt;372;</p>
<p>  SUM(BYTES)&#x2F;1024&#x2F;1024&#x2F;1024<br>  130.938721</p>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://www.flamingbytes.com/blog/big-red-book-report/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo/FlamingBytes-icon-64x64-1.png">
      <meta itemprop="name" content="relentlesstorm">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FlamingBytes">
      <meta itemprop="description" content="Stay hungry, stay foolish">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | FlamingBytes">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/big-red-book-report/" class="post-title-link" itemprop="url">Big Red Book Report</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-07 15:58:00" itemprop="dateCreated datePublished" datetime="2020-11-07T15:58:00-08:00">2020-11-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-10-22 11:28:20" itemprop="dateModified" datetime="2023-10-22T11:28:20-07:00">2023-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Young-Author/" itemprop="url" rel="index"><span itemprop="name">Young Author</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Danny Pickett is a man who is too poor to afford one of Mr. Haggins champion Irish Setters. However, he is drawn close to a dog called Big Red. Their friendship builds up as they know each other. Their loyalty and courage are tested during various hunts such as when they fought against Old Majesty, a massive bear.
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/big-red-book-report/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/25/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><span class="page-number current">26</span><a class="page-number" href="/page/27/">27</a><a class="page-number" href="/page/28/">28</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/27/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">relentlesstorm</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
